---
- name: Ensure Samba server and client is installed
  package:
    name: "{{ item }}"
    state: present
  become: yes
  loop: "{{ samba_server.packages }}"
- name: Ensure Samba has initial smb.conf
  copy:
    dest: /etc/samba/smb.conf
    src: smb.conf
  become: yes
- name: Ensure Samba service is enabled and started
  service:
    name: "{{ item }}"
    state: started
    enabled: yes
  become: yes
  loop: "{{ samba_server.service }}"
- name: Ensure firewall allows smb traffic
  firewalld:
    service: "{{ item.service }}"
    state: enabled
    permanent: yes
    immediate: yes
    zone: "{{ item.zone }}"
  become: yes
  loop: "{{ samba_server.firewall_service_enable }}"
