---
# This playbook configures the guest OS as Vagrant creates the VMs.
- name: Common configuration
  hosts: all
  roles:
    - role: base-config

- name: RHCSA VM Configuration
  hosts: rhcsa7
  roles:
    - role: vagrant-vm
    - role: nm-con-vagrant
    - role: nm-con-lab
    - role: lab-vm

- name: Configure FreeIPA hosts
  hosts: ipa_server
  roles:
    - role: freeipa-server
    - role: freeipa-server-lab-data

- name: Reboot
  hosts: all
  tasks:
    - name: Ensure the host is rebooted
      reboot:
        reboot_timeout: 300
      become: yes
