---
- name: Ensure export directories exists
  file:
    path: "{{ item.path }}"
    owner: "{{ item.owner }}"
    group: "{{ item.group }}"
    mode: "{{ item.mode }}"
    state: directory
  with_items:
    - { path: '/srv', owner: 'root', group: 'root', mode: '0755' }
    - { path: '/srv/samba', owner: 'root', group: 'root', mode: '0755' }
    - { path: '/data', owner: 'root', group: 'root', mode: '0755' }
  become: yes
- name: Ensure there is data in the /data directory
  file:
    path: /data/{{ item }}
    state: touch
  with_items:
    - datafile1
    - datafile2
  become: yes
- name: Ensure SAMBA server and client is installed
  package:
    name: "{{ item }}"
    state: present
  become: yes
  with_items:
    - samba
    - samba-client
    - samba-common-tools
- name: Ensure SAMBA is configured
  copy:
    dest: /etc/samba/smb.conf
    src: smb.conf
  become: yes
