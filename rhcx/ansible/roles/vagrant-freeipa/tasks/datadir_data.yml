---
- name: Ensure the SELinux policy for the public directory exists
  sefcontext:
    target: '/data(/.*)?'
    setype: public_content_rw_t
    state: present
  become: yes
  notify: serestore_data
- name: Ensure public data directory exists
  file:
    path: '/data'
    owner: root
    group: root
    mode: '0755'
    state: directory
  become: yes
- name: Ensure there is data in the /data directory
  file:
    path: /data/{{ item }}
    state: touch
    access_time: preserve
    modification_time: preserve
  with_items:
    - datafile1
    - datafile2
  become: yes
- name: Ensure data directory is exported via NFS
  copy:
    content: '/data *(rw)'
    dest: /etc/exports.d/data.exports
    owner: root
    group: root
    mode: '0644'
  become: yes
