---
- name: Ensure localhost is configured as a virtualization host
  hosts: localhost
  roles:
    - role: baseline
      tags: baseline
    - role: virtualization_host
      tags: virtualization_host

- name: Ensure virtual lab environment for rhcsa is configured
  hosts: localhost

  pre_tasks:
    - name: Ensure the required Vagrant baseboxes have been built
      include_role:
        name: basebox
      vars:
        distro: "{{ this.distro }}"
        version: "{{ this.version }}"
        configuration: "{{ this.configuration }}"
      loop:
        - { distro: rocky, version: "8.4", configuration: core }
        - { distro: rocky, version: "8.4", configuration: minimal }
        - { distro: rocky, version: "8.4", configuration: gse }
      loop_control:
        loop_var: this
      tags: basebox

  roles:
    - role: labenv_rhcsa
      tags: labenv_rhcsa
