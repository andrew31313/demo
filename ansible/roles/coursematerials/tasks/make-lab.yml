---
- name: Create a lab doc if none exists
  block:
    - name: Check if lab{{ chapter_num + 1 }}-{{ lab_num + 1 }} exists
      stat:
        path: "{{ courseroot }}/chapter{{ chapter_num + 1 }}/lab{{ chapter_num + 1 }}-{{ lab_num + 1 }}.md"
      register: labfile
    - name: Ensure lab{{ chapter_num + 1 }}-{{ lab_num + 1 }} is created from template if missing
      template:
        src: "lab.md.j2"
        dest: "{{ courseroot }}/chapter{{ chapter_num + 1 }}/lab{{ chapter_num + 1 }}-{{ lab_num + 1 }}.md"
        mode: '0644'
      when: not labfile.stat.exists
